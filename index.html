<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dexter's Lab - Ultimate Edition 🔪</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d0000 50%, #000000 100%);
            min-height: 100vh;
            color: #ff6b6b;
            overflow-x: hidden;
            position: relative;
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #000000 0%, #1a0000 50%, #2d0000 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-logo {
            font-size: 5rem;
            color: #ff0000;
            text-shadow: 0 0 50px rgba(255, 0, 0, 1);
            margin-bottom: 30px;
            animation: logoGlow 2s ease infinite;
        }

        @keyframes logoGlow {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.1); filter: brightness(1.5); }
        }

        .loading-bar {
            width: 400px;
            height: 20px;
            background: rgba(139, 0, 0, 0.3);
            border: 3px solid #8b0000;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff4444);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 12px;
        }

        .loading-tip {
            color: #cccccc;
            font-size: 1.2rem;
            text-align: center;
            max-width: 500px;
            margin-top: 20px;
            opacity: 0.9;
        }

        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #1a0000;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #8b0000, #ff0000);
            border-radius: 10px;
            border: 2px solid #4a0000;
        }

        .autosave-indicator {
            position: fixed;
            top: 25px;
            left: 25px;
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid #8b0000;
            border-radius: 15px;
            padding: 15px 20px;
            color: #4caf50;
            font-size: 1rem;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease;
            box-shadow: 0 0 30px rgba(76, 175, 80, 0.5);
        }

        .autosave-indicator.show {
            opacity: 1;
        }

        .health-container {
            position: fixed;
            bottom: 25px;
            left: 25px;
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid #8b0000;
            border-radius: 15px;
            padding: 15px 20px;
            z-index: 1000;
            min-width: 200px;
        }

        .health-bar {
            width: 180px;
            height: 25px;
            background: rgba(139, 0, 0, 0.3);
            border: 2px solid #8b0000;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff4444);
            width: 100%;
            transition: width 0.3s ease;
            border-radius: 12px;
        }

        .health-text {
            color: #ff4444;
            font-size: 0.9rem;
            text-align: center;
        }

        .game-layout {
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            min-height: 100vh;
            padding: 25px;
            gap: 30px;
            align-items: start;
        }

        .shop-container {
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(139, 0, 0, 0.7);
            border: 3px solid #8b0000;
            max-height: calc(100vh - 50px);
            overflow-y: auto;
        }

        .shop-title {
            font-size: 2.2rem;
            color: #ff4444;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 68, 68, 0.9);
        }

        .game-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px;
            gap: 20px;
        }

        .click-section {
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(139, 0, 0, 0.7);
            border: 3px solid #8b0000;
            display: flex;
            justify-content: center;
            align-items: center;
            order: 1;
        }

        .click-button {
            width: 300px;
            height: 300px;
            border: 5px solid #8b0000;
            border-radius: 25px;
            background: linear-gradient(45deg, #2a0000, #4a0000, #2a0000);
            font-size: 6rem;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 20px 50px rgba(139, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .click-button:hover {
            transform: scale(1.15);
            box-shadow: 0 25px 60px rgba(139, 0, 0, 0.9);
            border-color: #ff0000;
        }

        .click-button:active {
            transform: scale(0.95);
            animation: stabEffect 0.3s ease;
        }

        @keyframes stabEffect {
            0% { transform: scale(0.95); }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(0.95); }
        }

        .critical-hit {
            border-color: #ffff00 !important;
            box-shadow: 0 0 80px rgba(255, 255, 0, 1) !important;
            animation: criticalPulse 1s ease;
            background: linear-gradient(45deg, #4a0000, #ffff00, #4a0000) !important;
        }

        @keyframes criticalPulse {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.4) rotate(10deg); }
            75% { transform: scale(1.2) rotate(-5deg); }
        }

        .game-header {
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(139, 0, 0, 0.7);
            border: 3px solid #8b0000;
            text-align: center;
            max-width: 600px;
            width: 100%;
            order: 2;
        }

        .title {
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.9);
            color: #ff4444;
        }

        .quote {
            color: #999;
            font-style: italic;
            margin-bottom: 20px;
            font-size: 1rem;
        }

        .save-load-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .save-btn, .load-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #8b0000, #ff0000);
            border: 3px solid #ff4444;
            border-radius: 12px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-weight: bold;
        }

        .save-btn:hover, .load-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 0, 0, 0.6);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .stat {
            background: rgba(139, 0, 0, 0.4);
            padding: 15px;
            border-radius: 12px;
            border: 3px solid #8b0000;
            box-shadow: 0 8px 25px rgba(139, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        .stat:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(139, 0, 0, 0.6);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff4444;
            text-shadow: 0 0 15px rgba(255, 68, 68, 0.7);
        }

        .target-section {
            background: rgba(139, 0, 0, 0.4);
            padding: 15px;
            border-radius: 12px;
            border: 3px solid #8b0000;
            margin: 15px 0;
            box-shadow: 0 8px 25px rgba(139, 0, 0, 0.4);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .notifications-container {
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(139, 0, 0, 0.7);
            border: 3px solid #8b0000;
            max-height: calc(100vh - 50px);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .achievements-panel {
            min-height: 300px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: rgba(139, 0, 0, 0.1);
            border-radius: 12px;
            border: 2px solid #8b0000;
        }

        .achievements-panel::-webkit-scrollbar {
            width: 8px;
        }

        .achievements-panel::-webkit-scrollbar-track {
            background: rgba(139, 0, 0, 0.2);
            border-radius: 8px;
        }

        .achievements-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #8b0000, #ff0000);
            border-radius: 8px;
        }

        .achievements-title {
            font-size: 1.6rem;
            color: #ff4444;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 68, 68, 0.7);
        }

        .boss-alerts-panel {
            min-height: 250px;
        }

        .boss-alerts-title {
            font-size: 1.6rem;
            color: #ff4444;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 68, 68, 0.7);
        }

        .upgrades {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .upgrade {
            background: rgba(139, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            border: 3px solid #8b0000;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upgrade:hover {
            border-color: #ff0000;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(139, 0, 0, 0.6);
            background: rgba(139, 0, 0, 0.5);
        }

        .upgrade.affordable {
            border-color: #ff4444;
            background: rgba(255, 68, 68, 0.4);
            box-shadow: 0 0 15px rgba(255, 68, 68, 0.4);
        }

        .upgrade.unaffordable {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .upgrade-name {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: #ff4444;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.7);
        }

        .upgrade-description {
            color: #cccccc;
            font-size: 0.8rem;
            margin: 5px 0;
            font-style: italic;
        }

        .upgrade-cost {
            color: #ffaa44;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(255, 170, 68, 0.7);
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .achievement {
            background: linear-gradient(45deg, #8b0000, #ff0000, #8b0000);
            padding: 12px;
            border-radius: 10px;
            margin: 8px 0;
            animation: achievementSlide 1s ease;
            border: 3px solid #ff4444;
            box-shadow: 0 0 25px rgba(255, 68, 68, 0.7);
            text-shadow: 0 0 8px rgba(0, 0, 0, 1);
            font-weight: bold;
            font-size: 0.9rem;
        }

        @keyframes achievementSlide {
            0% { 
                transform: translateX(100%) scale(0.8); 
                opacity: 0; 
            }
            100% { 
                transform: translateX(0%) scale(1); 
                opacity: 1; 
            }
        }

        .boss-encounter-alert {
            background: linear-gradient(45deg, #8b0000, #ff0000, #8b0000);
            border: 4px solid #ff4444;
            border-radius: 15px;
            padding: 20px;
            margin: 12px 0;
            text-align: center;
            box-shadow: 0 0 40px rgba(255, 0, 0, 1);
            animation: alertPulse 2s ease infinite;
        }

        @keyframes alertPulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 40px rgba(255, 0, 0, 1); 
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 0 60px rgba(255, 0, 0, 1.3); 
            }
        }

        .boss-name {
            font-size: 1.5rem;
            color: #ffff00;
            text-shadow: 0 0 20px rgba(255, 255, 0, 1);
            margin-bottom: 10px;
        }

        .boss-alert-btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, #ff0000, #ff4444);
            border: 3px solid #ffff00;
            border-radius: 8px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-weight: bold;
            margin: 0 5px;
        }

        .boss-alert-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 255, 0, 0.6);
        }

        .hard-victim-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #8b0000, #ff0000, #8b0000);
            border: 5px solid #ff4444;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 0 60px rgba(255, 0, 0, 1.5);
            z-index: 5000;
            animation: hardVictimPulse 1.5s ease infinite;
            min-width: 350px;
        }

        @keyframes hardVictimPulse {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1); 
                box-shadow: 0 0 60px rgba(255, 0, 0, 1.5); 
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.1); 
                box-shadow: 0 0 100px rgba(255, 0, 0, 2); 
            }
        }

        .hard-victim-name {
            font-size: 2rem;
            color: #ffff00;
            text-shadow: 0 0 30px rgba(255, 255, 0, 1.5);
            margin-bottom: 15px;
            animation: nameFlicker 0.8s ease infinite;
        }

        @keyframes nameFlicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .spam-button {
            padding: 15px 30px;
            background: linear-gradient(45deg, #ff0000, #ff4444, #ff6666);
            border: 4px solid #ffff00;
            border-radius: 12px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(255, 255, 0, 0.8);
        }

        .spam-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(255, 255, 0, 1);
        }

        .spam-button:active {
            transform: scale(0.95);
        }

        .boss-arena {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0000 50%, #2a0000 100%);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .boss-arena.active {
            display: flex;
        }

        .boss-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 90%;
            max-width: 700px;
            margin-bottom: 25px;
        }

        .character-sprite {
            width: 150px;
            height: 200px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border: 4px solid #8b0000;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.7);
            position: relative;
            animation: spriteFloat 3s ease-in-out infinite;
        }

        @keyframes spriteFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .dexter-sprite {
            background-image: url('dexter.png');
        }

        .trinity-sprite {
            background-image: url('trinity.png');
        }

        .ice-truck-sprite {
            background-image: url('ice-truck.png');
        }

        .travis-sprite {
            background-image: url('travis.png');
        }

        .lila-sprite {
            background-image: url('lila.png');
        }

        .boss-health-bar {
            width: 80%;
            max-width: 400px;
            height: 25px;
            background: rgba(139, 0, 0, 0.3);
            border: 3px solid #8b0000;
            border-radius: 12px;
            overflow: hidden;
            margin: 12px 0;
        }

        .boss-health {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff4444);
            width: 100%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .boss-actions {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .boss-action-btn {
            padding: 10px 18px;
            background: linear-gradient(45deg, #8b0000, #ff0000);
            border: 3px solid #ff4444;
            border-radius: 8px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-weight: bold;
        }

        .boss-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 0, 0, 0.5);
        }

        .boss-dialogue {
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid #8b0000;
            border-radius: 10px;
            padding: 12px;
            margin: 12px 0;
            max-width: 400px;
            text-align: center;
            font-size: 1rem;
            color: #ff4444;
        }

        .critical-number {
            color: #ffff00 !important;
            font-size: 2.8rem !important;
            text-shadow: 
                0 0 30px rgba(255, 255, 0, 1),
                0 0 60px rgba(255, 255, 0, 0.8),
                0 0 90px rgba(255, 255, 0, 0.6) !important;
            animation: criticalFloat 2.5s ease-out forwards !important;
            font-weight: bold !important;
        }

        @keyframes criticalFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotate(0deg);
            }
            25% {
                transform: translateY(-15px) scale(1.6) rotate(8deg);
            }
            50% {
                transform: translateY(-30px) scale(1.4) rotate(-4deg);
            }
            75% {
                transform: translateY(-50px) scale(1.2) rotate(2deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-80px) scale(1) rotate(0deg);
            }
        }

        .floating-number {
            position: absolute;
            color: #ff4444;
            font-weight: bold;
            font-size: 2rem;
            pointer-events: none;
            animation: normalFloat 2s ease-out forwards;
            text-shadow: 
                0 0 20px rgba(255, 68, 68, 1),
                0 0 40px rgba(255, 68, 68, 0.8);
            font-family: 'Courier New', monospace;
            z-index: 1000;
        }

        @keyframes normalFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotate(0deg);
            }
            25% {
                transform: translateY(-12px) scale(1.3) rotate(5deg);
            }
            50% {
                transform: translateY(-25px) scale(1.2) rotate(-3deg);
            }
            75% {
                transform: translateY(-40px) scale(1.1) rotate(2deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-60px) scale(0.9) rotate(0deg);
            }
        }

        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 0, 0, 0.2);
            pointer-events: none;
            z-index: 999;
            opacity: 0;
            animation: flash 0.4s ease;
        }

        @keyframes flash {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .critical-flash {
            background: rgba(255, 255, 0, 0.4) !important;
            animation: criticalFlash 0.8s ease !important;
        }

        @keyframes criticalFlash {
            0%, 100% { opacity: 0; }
            25% { opacity: 1; }
            50% { opacity: 0.7; }
            75% { opacity: 1; }
        }

        .github-instructions {
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid #8b0000;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: #cccccc;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .github-instructions h3 {
            color: #ff4444;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.7);
        }

        .github-instructions code {
            background: rgba(139, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            color: #ffaa44;
        }

        @media (max-width: 1200px) {
            .game-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .shop-container, .notifications-container {
                max-height: 300px;
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .click-button {
                width: 220px;
                height: 220px;
                font-size: 4.5rem;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-logo">🔪 DEXTER'S LAB 🔪</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
        <div class="loading-tip" id="loadingTip">Preparing your kill room...</div>
    </div>

    <div class="autosave-indicator" id="autosaveIndicator">
        💾 Game Auto-Saved Successfully
    </div>

    <div class="health-container">
        <div class="health-bar">
            <div class="health-fill" id="healthFill"></div>
        </div>
        <div class="health-text" id="healthText">Health: 100/100</div>
    </div>

    <div class="boss-arena" id="bossArena">
        <div class="boss-container">
            <div class="character-sprite dexter-sprite" id="dexterSprite"></div>
            <div class="character-sprite" id="bossSprite"></div>
        </div>
        
        <div class="boss-health-bar">
            <div class="boss-health" id="bossHealth"></div>
        </div>
        
        <div class="boss-dialogue" id="bossDialogue">
            A dangerous killer approaches in the shadows...
        </div>
        
        <div class="boss-actions">
            <button class="boss-action-btn" onclick="bossAttack('stab')">🔪 DEADLY STAB</button>
            <button class="boss-action-btn" onclick="bossAttack('slice')">🗡️ PRECISE SLICE</button>
            <button class="boss-action-btn" onclick="bossAttack('follow')">👁️ TRACK & FOLLOW</button>
            <button class="boss-action-btn" onclick="bossAttack('analyze')">🧬 ANALYZE WEAKNESS</button>
            <button class="boss-action-btn" onclick="escapeBoss()">🏃 TACTICAL RETREAT</button>
        </div>
    </div>

    <div class="game-layout">
        <div class="shop-container">
            <div class="shop-title">🛒 SLY'S SHOP 🛒</div>
            <div class="upgrades">
                <div class="upgrade" id="upgrade1">
                    <div class="upgrade-name">🔪 Razor's Edge</div>
                    <div class="upgrade-description">Sharper than a serpent's fang</div>
                    <div>+1 kill per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost1">10</span> victims</div>
                </div>
                
                <div class="upgrade" id="upgrade2">
                    <div class="upgrade-name">🗡️ Blood Harvester</div>
                    <div class="upgrade-description">Reaps souls with surgical precision</div>
                    <div>+5 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost2">100</span> victims</div>
                </div>
                
                <div class="upgrade" id="upgrade3">
                    <div class="upgrade-name">💀 Soul Magnet</div>
                    <div class="upgrade-description">Attracts death automatically</div>
                    <div>+1 kill per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost3">50</span> victims</div>
                </div>
                
                <div class="upgrade" id="upgrade4">
                    <div class="upgrade-name">🏢 Death Factory</div>
                    <div class="upgrade-description">Mass production of demise</div>
                    <div>+10 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost4">500</span> victims</div>
                </div>
                
                <div class="upgrade" id="upgrade5">
                    <div class="upgrade-name">⚡ Lightning Execution</div>
                    <div class="upgrade-description">Strike faster than thought</div>
                    <div>+25 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost5">2000</span> victims</div>
                </div>
                
                <div class="upgrade" id="upgrade6">
                    <div class="upgrade-name">🌃 Night Reaper</div>
                    <div class="upgrade-description">Death walks in eternal darkness</div>
                    <div>+50 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost6">5000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade7">
                    <div class="upgrade-name">🧬 DNA Destroyer</div>
                    <div class="upgrade-description">Unravels life at its core</div>
                    <div>+100 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost7">10000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade8">
                    <div class="upgrade-name">🚢 Crimson Harbor</div>
                    <div class="upgrade-description">Where bodies find eternal rest</div>
                    <div>+200 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost8">25000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade9">
                    <div class="upgrade-name">👥 Trinity Protocol</div>
                    <div class="upgrade-description">Master the art of three</div>
                    <div>+500 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost9">50000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade10">
                    <div class="upgrade-name">🩸 Blood Archive</div>
                    <div class="upgrade-description">Memories preserved in crimson</div>
                    <div>+1000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost10">100000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade11">
                    <div class="upgrade-name">🌊 Tidal Massacre</div>
                    <div class="upgrade-description">Waves of endless destruction</div>
                    <div>+2500 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost11">250000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade12">
                    <div class="upgrade-name">🎭 Code Eternal</div>
                    <div class="upgrade-description">Harry's legacy lives forever</div>
                    <div>+5000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost12">500000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade13">
                    <div class="upgrade-name">🏥 Metro Morgue</div>
                    <div class="upgrade-description">Inside access to infinite victims</div>
                    <div>+10000 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost13">1000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade14">
                    <div class="upgrade-name">🔥 Infernal Judge</div>
                    <div class="upgrade-description">Divine judgment through flames</div>
                    <div>+25000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost14">2500000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade15">
                    <div class="upgrade-name">👁️ Omniscient Watcher</div>
                    <div class="upgrade-description">See all, judge all, end all</div>
                    <div>+50000 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost15">5000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade16">
                    <div class="upgrade-name">🌪️ Chaos Incarnate</div>
                    <div class="upgrade-description">Pure destruction unleashed</div>
                    <div>+100000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost16">10000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade17">
                    <div class="upgrade-name">🌋 Volcanic Wrath</div>
                    <div class="upgrade-description">Earth's fury in your hands</div>
                    <div>+250000 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost17">25000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade18">
                    <div class="upgrade-name">🌌 Cosmic Annihilator</div>
                    <div class="upgrade-description">Death that transcends dimensions</div>
                    <div>+500000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost18">50000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade19">
                    <div class="upgrade-name">⚫ Void Devourer</div>
                    <div class="upgrade-description">Consume reality itself</div>
                    <div>+1000000 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost19">100000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade20">
                    <div class="upgrade-name">🌟 Universal Ending</div>
                    <div class="upgrade-description">The final solution to existence</div>
                    <div>+10000000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost20">1000000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade21">
                    <div class="upgrade-name">💫 Reality Shredder</div>
                    <div class="upgrade-description">Tear through the fabric of being</div>
                    <div>+50000000 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost21">5000000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade22">
                    <div class="upgrade-name">🕳️ Dimensional Ripper</div>
                    <div class="upgrade-description">Break the barriers between worlds</div>
                    <div>+100000000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost22">10000000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade23">
                    <div class="upgrade-name">🔮 Fate Manipulator</div>
                    <div class="upgrade-description">Control destiny itself</div>
                    <div>+500000000 kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost23">50000000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade24">
                    <div class="upgrade-name">⚡ God Slayer</div>
                    <div class="upgrade-description">Even deities fear your blade</div>
                    <div>+1000000000 kills per second</div>
                    <div class="upgrade-cost">Cost: <span id="cost24">100000000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade25">
                    <div class="upgrade-name">🎆 Big Bang Reverser</div>
                    <div class="upgrade-description">Undo creation with a single click</div>
                    <div>+∞ kills per click</div>
                    <div class="upgrade-cost">Cost: <span id="cost25">1000000000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade26">
                    <div class="upgrade-name">🏆 Death Incarnate</div>
                    <div class="upgrade-description">Become the embodiment of death</div>
                    <div>+10% critical chance</div>
                    <div class="upgrade-cost">Cost: <span id="cost26">500000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade27">
                    <div class="upgrade-name">💰 Blood Money</div>
                    <div class="upgrade-description">Profit from every kill</div>
                    <div>+2x victim rewards</div>
                    <div class="upgrade-cost">Cost: <span id="cost27">1000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade28">
                    <div class="upgrade-name">🎯 Perfect Aim</div>
                    <div class="upgrade-description">Never miss your target</div>
                    <div>+15% critical chance</div>
                    <div class="upgrade-cost">Cost: <span id="cost28">2000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade29">
                    <div class="upgrade-name">🧪 Toxic Blood</div>
                    <div class="upgrade-description">Your victims spread death</div>
                    <div>+3x auto kills</div>
                    <div class="upgrade-cost">Cost: <span id="cost29">5000000</span> victims</div>
                </div>

                <div class="upgrade" id="upgrade30">
                    <div class="upgrade-name">👑 King of Killers</div>
                    <div class="upgrade-description">Rule over all serial killers</div>
                    <div>+5x all production</div>
                    <div class="upgrade-cost">Cost: <span id="cost30">10000000</span> victims</div>
                </div>
            </div>

            <div class="github-instructions">
                <h3>📁 GitHub PNG Setup Instructions:</h3>
                <p>To use custom PNG sprites instead of default ones:</p>
                <ol>
                    <li>Upload these PNG files to your GitHub repository:</li>
                    <ul>
                        <li><code>dexter.png</code> - Dexter Morgan sprite</li>
                        <li><code>trinity.png</code> - Trinity Killer sprite</li>
                        <li><code>ice-truck.png</code> - Ice Truck Killer sprite</li>
                        <li><code>travis.png</code> - Travis Marshall sprite</li>
                        <li><code>lila.png</code> - Lila West sprite</li>
                    </ul>
                    <li>Make sure images are <strong>150x200 pixels</strong> for best fit</li>
                    <li>The game will automatically load your PNG files</li>
                    <li>If PNG files are missing, it will show placeholder backgrounds</li>
                </ol>
                <p><strong>Pro Tip:</strong> Use transparent PNG backgrounds for best visual effect!</p>
            </div>
        </div>

        <div class="game-center">
            <div class="click-section">
                <button class="click-button" id="clickButton">🔪</button>
            </div>

            <div class="game-header">
                <h1 class="title">🔪 DEXTER'S LAB 🔪</h1>
                <div class="quote">
                    "Tonight's the night... and it's going to happen again and again."
                </div>
                
                <div class="save-load-controls">
                    <button class="save-btn" onclick="saveGame()">💾 SAVE GAME</button>
                    <button class="load-btn" onclick="loadGame()">📁 LOAD GAME</button>
                </div>
                
                <div class="stats">
                    <div class="stat">
                        <div>Victims</div>
                        <div class="stat-value" id="score">0</div>
                    </div>
                    <div class="stat">
                        <div>Kill Power</div>
                        <div class="stat-value" id="clickPower">1</div>
                    </div>
                    <div class="stat">
                        <div>Per Second</div>
                        <div class="stat-value" id="autoKills">0</div>
                    </div>
                    <div class="stat">
                        <div>Critical %</div>
                        <div class="stat-value" id="critChance">5</div>
                    </div>
                    <div class="stat">
                        <div>Boss Kills</div>
                        <div class="stat-value" id="bossKills">0</div>
                    </div>
                    <div class="stat">
                        <div>Body Parts</div>
                        <div class="stat-value" id="bodyParts">0</div>
                    </div>
                </div>

                <div class="target-section">
                    <div>🎯 Current Target: <span id="currentVictim">John Doe</span></div>
                    <div>🌙 Darkness Level: <span id="darknessLevel">1</span></div>
                </div>
            </div>
        </div>

        <div class="notifications-container">
            <div class="achievements-panel">
                <div class="achievements-title">🏆 ACHIEVEMENTS</div>
                <div id="achievements"></div>
            </div>

            <div class="boss-alerts-panel">
                <div class="boss-alerts-title">⚠️ BOSS ALERTS</div>
                <div id="bossAlerts"></div>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            score: 0,
            clickPower: 1,
            autoKills: 0,
            bodyParts: 0,
            criticalChance: 5,
            bossKills: 0,
            darknessLevel: 1,
            totalKills: 0,
            lastBossEncounter: 0,
            lastHardVictim: 0,
            health: 100,
            maxHealth: 100,
            upgrades: {}
        };

        for (let i = 1; i <= 30; i++) {
            const baseCosts = [10, 100, 50, 500, 2000, 5000, 10000, 25000, 50000, 100000, 250000, 500000, 1000000, 2500000, 5000000, 10000000, 25000000, 50000000, 100000000, 1000000000, 5000000000, 10000000000, 50000000000, 100000000000, 1000000000000, 500000, 1000000, 2000000, 5000000, 10000000];
            gameState.upgrades[`upgrade${i}`] = { 
                cost: baseCosts[i-1] || Math.pow(10, i), 
                owned: 0, 
                baseCost: baseCosts[i-1] || Math.pow(10, i) 
            };
        }

        let allAchievements = [];

        const bosses = {
            trinity: {
                name: "Trinity Killer",
                health: 800,
                maxHealth: 800,
                sprite: "trinity-sprite",
                dialogue: [
                    "I am the Alpha and Omega, the beginning and the end...",
                    "Your dark passenger is nothing compared to my divine mission...",
                    "Four walls make the perfect tomb for your soul...",
                    "I have been killing longer than you've existed...",
                    "The cycle of death must continue through me..."
                ],
                rewards: { score: 25000, clickPower: 400, critChance: 2 }
            },
            iceTruck: {
                name: "Ice Truck Killer",
                health: 600,
                maxHealth: 600,
                sprite: "ice-truck-sprite",
                dialogue: [
                    "Hello, Dexter Morgan, my dear brother...",
                    "We're connected by blood and darkness...",
                    "I left you gifts to remember me by...",
                    "The ice preserves their beauty forever...",
                    "You cannot escape your true nature..."
                ],
                rewards: { score: 18000, clickPower: 250, critChance: 1.5 }
            },
            travis: {
                name: "Travis Marshall",
                health: 700,
                maxHealth: 700,
                sprite: "travis-sprite",
                dialogue: [
                    "The apocalypse is coming through me...",
                    "I am the vessel of divine retribution...",
                    "You cannot stop the end of days...",
                    "My angels will guide me to victory...",
                    "Religious fervor fuels my blade..."
                ],
                rewards: { score: 22000, clickPower: 350, critChance: 1.8 }
            },
            lila: {
                name: "Lila West",
                health: 500,
                maxHealth: 500,
                sprite: "lila-sprite",
                dialogue: [
                    "I know exactly who you really are, Dexter...",
                    "We're the same, you and me, creatures of darkness...",
                    "Let me help you embrace your true self...",
                    "Fire cleanses everything, including your lies...",
                    "You can't run from what you truly are..."
                ],
                rewards: { score: 12000, clickPower: 180, critChance: 1 }
            }
        };

        let currentBoss = null;

        const achievements = [
            { id: 'firstKill', name: 'First Blood 🔪', condition: (state) => state.score >= 1, unlocked: false },
            { id: 'criticalMaster', name: 'Critical Master ⚡', condition: (state) => state.criticalChance >= 30, unlocked: false },
            { id: 'serialKiller', name: 'Serial Killer 💀', condition: (state) => state.score >= 10, unlocked: false },
            { id: 'massMurderer', name: 'Mass Murderer 🩸', condition: (state) => state.score >= 100, unlocked: false },
            { id: 'bossHunter', name: 'Boss Hunter 👹', condition: (state) => state.bossKills >= 1, unlocked: false },
            { id: 'thousandKills', name: 'Thousand Souls 💀', condition: (state) => state.score >= 1000, unlocked: false },
            { id: 'darkLord', name: 'Dark Lord 🌑', condition: (state) => state.darknessLevel >= 10, unlocked: false },
            { id: 'bodyCollector', name: 'Body Collector 🫀', condition: (state) => state.bodyParts >= 1000, unlocked: false },
            { id: 'bossSlayer', name: 'Boss Slayer 👑', condition: (state) => state.bossKills >= 5, unlocked: false },
            { id: 'millionaire', name: 'Million Killer 💰', condition: (state) => state.score >= 1000000, unlocked: false },
            { id: 'survivor', name: 'Survivor 💚', condition: (state) => state.health >= 80, unlocked: false },
            { id: 'nearDeath', name: 'Near Death 💀', condition: (state) => state.health <= 10, unlocked: false }
        ];

        const victimNames = [
            "Arthur Mitchell", "Miguel Prado", "James Doakes", "Trinity Killer",
            "Hannah McKay", "Jordan Chase", "Travis Marshall", "Ice Truck Killer",
            "Oliver Saxon", "Kurt Caldwell", "Lila West", "Brian Moser",
            "Boyd Fowler", "Jeremy Downs", "Neil Perry", "Carlos Guerrero"
        ];

        const hardVictimNames = [
            "ARTHUR MITCHELL", "MIGUEL PRADO", "JORDAN CHASE", "TRAVIS MARSHALL",
            "OLIVER SAXON", "KURT CALDWELL", "BOYD FOWLER", "EUGENE GREER"
        ];

        const loadingTips = [
            "Tip: Click faster for more kills!",
            "Tip: Buy upgrades to increase your power!",
            "Tip: Critical hits deal massive damage!",
            "Tip: Boss fights give huge rewards!",
            "Tip: Don't let hard victims escape!",
            "Tip: Keep your health above 0 to survive!",
            "Tip: Darkness level increases with kills!",
            "Tip: Upload PNG sprites to GitHub for custom graphics!",
            "Tip: Auto-save happens every 15 seconds!"
        ];

        const scoreElement = document.getElementById('score');
        const clickPowerElement = document.getElementById('clickPower');
        const autoKillsElement = document.getElementById('autoKills');
        const critChanceElement = document.getElementById('critChance');
        const bossKillsElement = document.getElementById('bossKills');
        const bodyPartsElement = document.getElementById('bodyParts');
        const currentVictimElement = document.getElementById('currentVictim');
        const darknessLevelElement = document.getElementById('darknessLevel');
        const clickButton = document.getElementById('clickButton');
        const achievementsElement = document.getElementById('achievements');
        const bossAlertsElement = document.getElementById('bossAlerts');
        const autosaveIndicator = document.getElementById('autosaveIndicator');
        const healthFill = document.getElementById('healthFill');
        const healthText = document.getElementById('healthText');

        function showLoadingScreen() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingProgress = document.getElementById('loadingProgress');
            const loadingTip = document.getElementById('loadingTip');
            
            let progress = 0;
            let tipIndex = 0;
            
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress > 100) progress = 100;
                
                loadingProgress.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                    }, 500);
                }
            }, 200);
            
            const tipInterval = setInterval(() => {
                loadingTip.textContent = loadingTips[tipIndex];
                tipIndex = (tipIndex + 1) % loadingTips.length;
                
                if (progress >= 100) {
                    clearInterval(tipInterval);
                }
            }, 1000);
        }

        function showAutosaveIndicator() {
            autosaveIndicator.classList.add('show');
            setTimeout(() => {
                autosaveIndicator.classList.remove('show');
            }, 2000);
        }

        function updateHealthDisplay() {
            const healthPercent = (gameState.health / gameState.maxHealth) * 100;
            healthFill.style.width = healthPercent + '%';
            healthText.textContent = `Health: ${Math.floor(gameState.health)}/${gameState.maxHealth}`;
            
            if (gameState.health <= 0) {
                gameState.health = 0;
                showAchievement('💀 YOU DIED! Game will reset in 5 seconds...');
                setTimeout(() => {
                    resetGame();
                }, 5000);
            }
        }

        function resetGame() {
            gameState = {
                score: 0,
                clickPower: 1,
                autoKills: 0,
                bodyParts: 0,
                criticalChance: 5,
                bossKills: 0,
                darknessLevel: 1,
                totalKills: 0,
                lastBossEncounter: 0,
                lastHardVictim: 0,
                health: 100,
                maxHealth: 100,
                upgrades: {}
            };
            
            for (let i = 1; i <= 30; i++) {
                const baseCosts = [10, 100, 50, 500, 2000, 5000, 10000, 25000, 50000, 100000, 250000, 500000, 1000000, 2500000, 5000000, 10000000, 25000000, 50000000, 100000000, 1000000000, 5000000000, 10000000000, 50000000000, 100000000000, 1000000000000, 500000, 1000000, 2000000, 5000000, 10000000];
                gameState.upgrades[`upgrade${i}`] = { 
                    cost: baseCosts[i-1] || Math.pow(10, i), 
                    owned: 0, 
                    baseCost: baseCosts[i-1] || Math.pow(10, i) 
                };
            }
            
            achievements.forEach(achievement => achievement.unlocked = false);
            allAchievements = [];
            achievementsElement.innerHTML = '';
            updateDisplay();
            showAchievement('🔄 Game Reset! Start your killing spree again!');
        }

        function autoSave() {
            localStorage.setItem('dexterUltimateFinalGameState', JSON.stringify(gameState));
            showAutosaveIndicator();
        }

        function isCriticalHit() {
            return Math.random() * 100 < gameState.criticalChance;
        }

        function updateDisplay() {
            scoreElement.textContent = formatNumber(Math.floor(gameState.score));
            clickPowerElement.textContent = formatNumber(gameState.clickPower);
            autoKillsElement.textContent = formatNumber(gameState.autoKills);
            critChanceElement.textContent = Math.floor(gameState.criticalChance);
            bossKillsElement.textContent = gameState.bossKills;
            bodyPartsElement.textContent = formatNumber(Math.floor(gameState.bodyParts));
            darknessLevelElement.textContent = gameState.darknessLevel;
            updateHealthDisplay();

            Object.keys(gameState.upgrades).forEach(upgradeId => {
                const upgrade = document.getElementById(upgradeId);
                if (upgrade) {
                    const cost = gameState.upgrades[upgradeId].cost;
                    
                    if (gameState.score >= cost) {
                        upgrade.classList.add('affordable');
                        upgrade.classList.remove('unaffordable');
                    } else {
                        upgrade.classList.remove('affordable');
                        upgrade.classList.add('unaffordable');
                    }
                }
            });
        }

        function formatNumber(num) {
            if (num < 1000) return num.toString();
            if (num < 1000000) return (num / 1000).toFixed(1) + 'K';
            if (num < 1000000000) return (num / 1000000).toFixed(1) + 'M';
            if (num < 1000000000000) return (num / 1000000000).toFixed(1) + 'B';
            return (num / 1000000000000).toFixed(1) + 'T';
        }

        function checkBossEncounter() {
            const currentTime = Date.now();
            if (currentTime - gameState.lastBossEncounter > 12000) {
                if (Math.random() < 0.04) {
                    triggerBossEncounter();
                    gameState.lastBossEncounter = currentTime;
                }
            }
        }

        function checkHardVictim() {
            const currentTime = Date.now();
            if (currentTime - gameState.lastHardVictim > 6000) {
                if (Math.random() < 0.1) {
                    triggerHardVictim();
                    gameState.lastHardVictim = currentTime;
                }
            }
        }

        function triggerHardVictim() {
            const hardVictimName = hardVictimNames[Math.floor(Math.random() * hardVictimNames.length)];
            
            const hardVictimDiv = document.createElement('div');
            hardVictimDiv.className = 'hard-victim-alert';
            hardVictimDiv.innerHTML = `
                <div class="hard-victim-name">${hardVictimName}</div>
                <div style="margin: 12px 0; color: #cccccc; font-size: 1.1rem;">HARD VICTIM DETECTED! SPAM TO CAPTURE!</div>
                <button class="spam-button" onclick="spamVictim('${hardVictimName}', this.parentElement)">🔪 CAPTURE ${hardVictimName}!</button>
            `;
            
            document.body.appendChild(hardVictimDiv);
            
            let spamCount = 0;
            const requiredSpams = 12;
            let healthDrain = setInterval(() => {
                gameState.health -= 2.5;
                updateHealthDisplay();
                
                if (gameState.health <= 0 || spamCount >= requiredSpams) {
                    clearInterval(healthDrain);
                    if (document.body.contains(hardVictimDiv)) {
                        hardVictimDiv.remove();
                    }
                }
            }, 400);
            
            setTimeout(() => {
                clearInterval(healthDrain);
                if (document.body.contains(hardVictimDiv)) {
                    hardVictimDiv.remove();
                    if (spamCount < requiredSpams) {
                        showAchievement('💔 Hard victim escaped! Health penalty!');
                        gameState.health -= 12;
                        updateHealthDisplay();
                    }
                }
            }, 6000);
            
            hardVictimDiv.spamCount = 0;
            hardVictimDiv.requiredSpams = requiredSpams;
            hardVictimDiv.healthDrain = healthDrain;
        }

        function spamVictim(victimName, alertDiv) {
            if (!alertDiv.spamCount) alertDiv.spamCount = 0;
            alertDiv.spamCount++;
            
            const spamButton = alertDiv.querySelector('.spam-button');
            spamButton.textContent = `🔪 CAPTURE! (${alertDiv.spamCount}/${alertDiv.requiredSpams})`;
            
            if (alertDiv.spamCount >= alertDiv.requiredSpams) {
                clearInterval(alertDiv.healthDrain);
                
                const reward = gameState.clickPower * 40;
                gameState.score += reward;
                gameState.health = Math.min(gameState.maxHealth, gameState.health + 15);
                
                showAchievement(`💰 Captured ${victimName}! +${formatNumber(reward)} victims & +15 health!`);
                
                alertDiv.remove();
                updateDisplay();
            }
        }

        function triggerBossEncounter() {
            const bossKeys = Object.keys(bosses);
            const randomBoss = bossKeys[Math.floor(Math.random() * bossKeys.length)];
            currentBoss = { ...bosses[randomBoss], key: randomBoss };
            
            showBossAlert();
        }

        function showBossAlert() {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'boss-encounter-alert';
            alertDiv.innerHTML = `
                <div class="boss-name">${currentBoss.name.toUpperCase()} DETECTED!</div>
                <div style="margin: 10px 0; color: #cccccc; font-size: 0.9rem;">A legendary serial killer stalks the shadows!</div>
                <button class="boss-alert-btn" onclick="acceptBossFight()">🩸 HUNT THEM DOWN</button>
                <button class="boss-alert-btn" onclick="declineBossFight()">👻 IGNORE FOR NOW</button>
            `;
            
            bossAlertsElement.appendChild(alertDiv);
            
            setTimeout(() => {
                if (bossAlertsElement.contains(alertDiv)) {
                    alertDiv.remove();
                    currentBoss = null;
                }
            }, 7000);
        }

        function acceptBossFight() {
            const bossArena = document.getElementById('bossArena');
            const bossSprite = document.getElementById('bossSprite');
            const bossHealth = document.getElementById('bossHealth');
            const bossDialogue = document.getElementById('bossDialogue');
            
            bossAlertsElement.innerHTML = '';
            
            bossArena.classList.add('active');
            
            bossSprite.className = `character-sprite ${currentBoss.sprite}`;
            bossHealth.style.width = '100%';
            bossDialogue.textContent = currentBoss.dialogue[0];
        }

        function declineBossFight() {
            bossAlertsElement.innerHTML = '';
            currentBoss = null;
        }

        function bossAttack(attackType) {
            if (!currentBoss) return;
            
            let damage = 0;
            const bossDialogue = document.getElementById('bossDialogue');
            
            switch (attackType) {
                case 'stab':
                    damage = gameState.clickPower * 2.2;
                    bossDialogue.textContent = "Your blade pierces through their defenses!";
                    break;
                case 'slice':
                    damage = gameState.clickPower * 1.8;
                    bossDialogue.textContent = "A masterful slice across their weakness!";
                    break;
                case 'follow':
                    damage = gameState.clickPower * 3.5;
                    bossDialogue.textContent = "You tracked them to their fatal flaw!";
                    break;
                case 'analyze':
                    damage = gameState.clickPower * 2.8;
                    bossDialogue.textContent = "Analysis reveals their critical vulnerability!";
                    break;
            }
            
            currentBoss.health -= damage;
            
            const bossHealth = document.getElementById('bossHealth');
            const healthPercent = Math.max(0, (currentBoss.health / currentBoss.maxHealth) * 100);
            bossHealth.style.width = healthPercent + '%';
            
            if (currentBoss.health <= 0) {
                defeatedBoss();
            } else {
                setTimeout(() => {
                    const randomDialogue = currentBoss.dialogue[Math.floor(Math.random() * currentBoss.dialogue.length)];
                    bossDialogue.textContent = randomDialogue;
                }, 1200);
            }
        }

        function defeatedBoss() {
            const bossArena = document.getElementById('bossArena');
            
            gameState.score += currentBoss.rewards.score;
            gameState.clickPower += currentBoss.rewards.clickPower;
            gameState.criticalChance += currentBoss.rewards.critChance;
            gameState.bossKills++;
            gameState.health = Math.min(gameState.maxHealth, gameState.health + 25);
            
            showAchievement(`Defeated ${currentBoss.name}! 👑 Massive power boost!`);
            
            bossArena.classList.remove('active');
            currentBoss = null;
            
            updateDisplay();
            checkAchievements();
        }

        function escapeBoss() {
            const bossArena = document.getElementById('bossArena');
            
            bossArena.classList.remove('active');
            currentBoss = null;
            
            showAchievement('You escaped into the shadows... this time. 🏃');
        }

        clickButton.addEventListener('click', (e) => {
            const isCrit = isCriticalHit();
            let kills = gameState.clickPower;
            
            if (isCrit) {
                kills *= 4;
                clickButton.classList.add('critical-hit');
                setTimeout(() => clickButton.classList.remove('critical-hit'), 1000);
            }
            
            gameState.score += kills;
            gameState.totalKills += kills;
            gameState.bodyParts += kills * 0.2;
            gameState.darknessLevel = Math.floor(gameState.totalKills / 100) + 1;
            
            if (gameState.criticalChance < 60) {
                gameState.criticalChance += 0.02;
            }
            
            createScreenFlash(isCrit);
            createFloatingNumber(e, kills, isCrit);
            
            if (Math.random() < 0.7) {
                currentVictimElement.textContent = victimNames[Math.floor(Math.random() * victimNames.length)];
            }
            
            updateDisplay();
            checkAchievements();
        });

        function createScreenFlash(isCritical = false) {
            const flash = document.createElement('div');
            flash.className = isCritical ? 'screen-flash critical-flash' : 'screen-flash';
            document.body.appendChild(flash);
            
            setTimeout(() => {
                if (document.body.contains(flash)) {
                    document.body.removeChild(flash);
                }
            }, isCritical ? 800 : 400);
        }

        function createFloatingNumber(event, value, isCritical = false) {
            const floatingNumber = document.createElement('div');
            floatingNumber.className = isCritical ? 'floating-number critical-number' : 'floating-number';
            floatingNumber.textContent = (isCritical ? 'MEGA CRIT! +' : '+') + formatNumber(value);
            floatingNumber.style.left = (event.clientX + Math.random() * 120 - 60) + 'px';
            floatingNumber.style.top = (event.clientY + Math.random() * 120 - 60) + 'px';
            
            if (!isCritical) {
                const colors = ['#ff4444', '#ff6666', '#ff8888', '#ffaaaa'];
                floatingNumber.style.color = colors[Math.floor(Math.random() * colors.length)];
            }
            
            document.body.appendChild(floatingNumber);
            
            setTimeout(() => {
                if (document.body.contains(floatingNumber)) {
                    document.body.removeChild(floatingNumber);
                }
            }, isCritical ? 2500 : 2000);
        }

        function showAchievement(name) {
            const achievementDiv = document.createElement('div');
            achievementDiv.className = 'achievement';
            achievementDiv.innerHTML = `🏆 ${name}`;
            
            allAchievements.push(achievementDiv);
            achievementsElement.appendChild(achievementDiv);
        }

        function checkAchievements() {
            achievements.forEach(achievement => {
                if (!achievement.unlocked && achievement.condition(gameState)) {
                    achievement.unlocked = true;
                    showAchievement(achievement.name);
                }
            });
        }

        const upgradeEffects = {
            upgrade1: () => gameState.clickPower += 1,
            upgrade2: () => gameState.clickPower += 5,
            upgrade3: () => gameState.autoKills += 1,
            upgrade4: () => gameState.autoKills += 10,
            upgrade5: () => gameState.clickPower += 25,
            upgrade6: () => gameState.autoKills += 50,
            upgrade7: () => gameState.clickPower += 100,
            upgrade8: () => gameState.autoKills += 200,
            upgrade9: () => gameState.clickPower += 500,
            upgrade10: () => gameState.autoKills += 1000,
            upgrade11: () => gameState.clickPower += 2500,
            upgrade12: () => gameState.autoKills += 5000,
            upgrade13: () => gameState.clickPower += 10000,
            upgrade14: () => gameState.autoKills += 25000,
            upgrade15: () => gameState.clickPower += 50000,
            upgrade16: () => gameState.autoKills += 100000,
            upgrade17: () => gameState.clickPower += 250000,
            upgrade18: () => gameState.autoKills += 500000,
            upgrade19: () => gameState.clickPower += 1000000,
            upgrade20: () => gameState.autoKills += 10000000,
            upgrade21: () => gameState.clickPower += 50000000,
            upgrade22: () => gameState.autoKills += 100000000,
            upgrade23: () => gameState.clickPower += 500000000,
            upgrade24: () => gameState.autoKills += 1000000000,
            upgrade25: () => gameState.clickPower = gameState.clickPower * 1000,
            upgrade26: () => gameState.criticalChance += 10,
            upgrade27: () => gameState.autoKills = gameState.autoKills * 2,
            upgrade28: () => gameState.criticalChance += 15,
            upgrade29: () => gameState.autoKills = gameState.autoKills * 3,
            upgrade30: () => {
                gameState.clickPower *= 5;
                gameState.autoKills *= 5;
                gameState.criticalChance += 20;
            }
        };

        Object.keys(upgradeEffects).forEach(upgradeId => {
            const element = document.getElementById(upgradeId);
            if (element) {
                element.addEventListener('click', () => buyUpgrade(upgradeId, upgradeEffects[upgradeId]));
            }
        });

        function buyUpgrade(upgradeId, effect) {
            const upgrade = gameState.upgrades[upgradeId];
            if (gameState.score >= upgrade.cost) {
                gameState.score -= upgrade.cost;
                upgrade.owned++;
                effect();
                
                gameState.criticalChance += 0.8;
                
                upgrade.cost = Math.floor(upgrade.baseCost * Math.pow(1.15, upgrade.owned));
                const costElement = document.getElementById(upgradeId.replace('upgrade', 'cost'));
                if (costElement) {
                    costElement.textContent = formatNumber(upgrade.cost);
                }
                
                updateDisplay();
                showPurchaseEffect(upgradeId);
            }
        }

        function showPurchaseEffect(upgradeId) {
            const upgrade = document.getElementById(upgradeId);
            upgrade.style.transform = 'scale(1.15)';
            upgrade.style.boxShadow = '0 0 50px rgba(255, 0, 0, 1)';
            
            setTimeout(() => {
                upgrade.style.transform = '';
                upgrade.style.boxShadow = '';
            }, 600);
        }

        function saveGame() {
            localStorage.setItem('dexterUltimateFinalGameState', JSON.stringify(gameState));
            showAchievement('Game Saved Successfully! 💾');
        }

        function loadGame() {
            const savedGame = localStorage.getItem('dexterUltimateFinalGameState');
            if (savedGame) {
                try {
                    gameState = { ...gameState, ...JSON.parse(savedGame) };
                    updateDisplay();
                    showAchievement('Game Loaded Successfully! 📁');
                } catch (e) {
                    showAchievement('Load Failed! ❌');
                }
            } else {
                showAchievement('No Save Found! ❌');
            }
        }

        setInterval(() => {
            if (gameState.autoKills > 0) {
                gameState.score += gameState.autoKills;
                gameState.totalKills += gameState.autoKills;
                gameState.bodyParts += gameState.autoKills * 0.1;
                gameState.darknessLevel = Math.floor(gameState.totalKills / 100) + 1;
                updateDisplay();
                checkAchievements();
            }
        }, 1000);

        setInterval(() => {
            checkBossEncounter();
        }, 2500);

        setInterval(() => {
            checkHardVictim();
        }, 1500);

        setInterval(autoSave, 15000);

        window.addEventListener('load', () => {
            showLoadingScreen();
            currentVictimElement.textContent = victimNames[Math.floor(Math.random() * victimNames.length)];
            updateDisplay();
            
            const savedGame = localStorage.getItem('dexterUltimateFinalGameState');
            if (savedGame) {
                try {
                    gameState = { ...gameState, ...JSON.parse(savedGame) };
                    updateDisplay();
                } catch (e) {
                    console.log('Could not load saved game');
                }
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'X') {
                gameState.score += 1000000;
                gameState.clickPower += 10000;
                gameState.health = gameState.maxHealth;
                updateDisplay();
                showAchievement('Ultimate Cheat Activated! 🎮');
            }
        });
    </script>
</body>
</html></parameter>
</invoke>
